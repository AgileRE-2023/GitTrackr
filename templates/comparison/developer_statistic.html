{% load static tailwind_tags %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Developer Statistic</title>
    {% tailwind_css %}
  </head>

  <body>
    <!-- Navbar Start -->
    {% block section %}
    {% include "component/navbar_logged.html" %}
    {% endblock %}
    <!-- Navbar End -->

    <!-- Content Start -->
    <div class="bg-white">
      <div class="mx-6 pt-[100px] lg:mx-28">
        <button class="flex items-center back-button">
          <svg
            width="15"
            height="16"
            viewBox="0 0 15 16"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M6.60901 0.543593L0.356415 6.78845C0.242567 6.90723 0.153324 7.04729 0.0938059 7.20061C-0.0312686 7.50468 -0.0312686 7.84575 0.0938059 8.14982C0.153324 8.30314 0.242567 8.4432 0.356415 8.56198L6.60901 14.8068C6.72561 14.9233 6.86403 15.0157 7.01637 15.0787C7.16871 15.1417 7.33199 15.1741 7.49688 15.1741C7.8299 15.1741 8.14927 15.042 8.38475 14.8068C8.62023 14.5717 8.75252 14.2527 8.75252 13.9201C8.75252 13.5875 8.62023 13.2685 8.38475 13.0333L4.25804 8.92418H13.7495C14.0811 8.92418 14.3992 8.7926 14.6337 8.55837C14.8682 8.32414 15 8.00646 15 7.67521C15 7.34397 14.8682 7.02629 14.6337 6.79206C14.3992 6.55783 14.0811 6.42624 13.7495 6.42624L4.25804 6.42624L8.38475 2.31713C8.50196 2.20102 8.59499 2.06289 8.65848 1.91069C8.72197 1.75849 8.75465 1.59524 8.75465 1.43036C8.75465 1.26548 8.72197 1.10223 8.65848 0.950037C8.59499 0.797838 8.50196 0.659702 8.38475 0.543593C8.2685 0.42653 8.13019 0.333611 7.9778 0.270203C7.82542 0.206794 7.66197 0.17415 7.49688 0.17415C7.3318 0.17415 7.16835 0.206794 7.01596 0.270203C6.86357 0.333611 6.72527 0.42653 6.60901 0.543593Z"
              fill="#A3A3A3"
            />
          </svg>
          <div
            class="text-neutral-400 text-base font-medium p-2"
            >
            back
          </div>
        </button>
        <div class="grid gap-0">
          <h2 class="text-black text-base font-bold lg:text-2xl">
            {{ repository_name }}
          </h2>
          <p class="text-black text-xs font-normal lg: text-base">
            owned by {{ owner_name }}
          </p>
        </div>
      </div>
      <div class="mx-6 my-5 shadow shadow-xl rounded-lg flex flex-col lg:mx-28 lg:my-10">
        <div class="px-4 bg-sky-100 rounded-t-lg">
          <h1 class="text-neutral-600 text-base font-semibold py-4 lg:text-xl">
            Comparison
          </h1>
          <!-- <p class="text-neutral-400 text-base font-normal ">Total Comparison per Contributors</p> -->
        </div>
        <div class="flex-1 overflow-x-auto py-6 px-4">
          <table class="w-full table-auto">
            <thead class="">
              <tr class="text-neutral-500 text-xl items-center m-2 text-center">
                <th
                  class="text-center border border-gray-300 border-t-0 border-l-0"
                  data-sort="Developer_Name"
                >
                  <div class="flex items-center py-2 px-4 w-80 cursor-pointer">
                    <svg
                      width="21"
                      height="16"
                      viewBox="0 0 21 16"
                      fill="currentColor"
                      xmlns="http://www.w3.org/2000/svg"
                      class="text-gray-500 mr-2"
                    >
                      <path
                        d="M10.5238 10.381L15.2857 15.1429M15.2857 15.1429L20.0476 10.381M15.2857 15.1429V0.857142M1 5.61905L5.7619 0.857142M5.7619 0.857142L10.5238 5.61905M5.7619 0.857142L5.7619 15.1429"
                        stroke="currentColor"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                    </svg>
                    <p
                      class="text-neutral-500 text-base font-medium font-['Inter'] lg:text-xl"
                    >
                    Developer Name
                    </p>
                  </div>
                </th>
                <th
                  class="text-center border border-gray-300 border-t-0"
                  data-sort="Commit"
                >
                  <div class="flex items-center justify-center py-2 px-2 cursor-pointer">
                    <svg
                      width="21"
                      height="16"
                      viewBox="0 0 21 16"
                      fill="currentColor"
                      xmlns="http://www.w3.org/2000/svg"
                      class="text-gray-500 mr-2"
                    >
                      <path
                        d="M10.5238 10.381L15.2857 15.1429M15.2857 15.1429L20.0476 10.381M15.2857 15.1429V0.857142M1 5.61905L5.7619 0.857142M5.7619 0.857142L10.5238 5.61905M5.7619 0.857142L5.7619 15.1429"
                        stroke="currentColor"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                    </svg>
                    <p
                      class="text-neutral-500 text-base font-medium font-['Inter'] lg:text-xl"
                    >
                      Commit
                    </p>
                  </div>
                </th>
                <th
                  class="text-center border border-gray-300 border-t-0"
                  data-sort="Additions"
                >
                  <div
                    class="flex items-center justify-center py-2 px-2 cursor-pointer"
                  >
                    <svg
                      width="21"
                      height="16"
                      viewBox="0 0 21 16"
                      fill="currentColor"
                      xmlns="http://www.w3.org/2000/svg"
                      class="text-gray-500 mr-2"
                    >
                      <path
                        d="M10.5238 10.381L15.2857 15.1429M15.2857 15.1429L20.0476 10.381M15.2857 15.1429V0.857142M1 5.61905L5.7619 0.857142M5.7619 0.857142L10.5238 5.61905M5.7619 0.857142L5.7619 15.1429"
                        stroke="currentColor"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                    </svg>
                    <p
                      class="text-neutral-500 text-base font-medium font-['Inter'] lg:text-xl"
                    >
                      Additions
                    </p>
                  </div>
                </th>
                <th
                  class="text-center border border-gray-300 border-t-0"
                  data-sort="Deletions"
                >
                  <div
                    class="flex items-center justify-center py-2 px-2 cursor-pointer"
                  >
                    <svg
                      width="21"
                      height="16"
                      viewBox="0 0 21 16"
                      fill="currentColor"
                      xmlns="http://www.w3.org/2000/svg"
                      class="text-gray-500 mr-2"
                    >
                      <path
                        d="M10.5238 10.381L15.2857 15.1429M15.2857 15.1429L20.0476 10.381M15.2857 15.1429V0.857142M1 5.61905L5.7619 0.857142M5.7619 0.857142L10.5238 5.61905M5.7619 0.857142L5.7619 15.1429"
                        stroke="currentColor"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                    </svg>
                    <p
                      class="text-neutral-500 text-base font-medium font-['Inter'] lg:text-xl"
                    >
                      Deletions
                    </p>
                  </div>
                </th>
                <th
                  class="text-center border border-gray-300 border-t-0 border-r-0"
                  data-sort="Pull_Request"
                >
                  <div
                    class="flex items-center justify-center py-2 px-2 cursor-pointer"
                  >
                    <svg
                      width="21"
                      height="16"
                      viewBox="0 0 21 16"
                      fill="currentColor"
                      xmlns="http://www.w3.org/2000/svg"
                      class="text-gray-500 mr-2"
                    >
                      <path
                        d="M10.5238 10.381L15.2857 15.1429M15.2857 15.1429L20.0476 10.381M15.2857 15.1429V0.857142M1 5.61905L5.7619 0.857142M5.7619 0.857142L10.5238 5.61905M5.7619 0.857142L5.7619 15.1429"
                        stroke="currentColor"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                    </svg>
                    <p
                      class="text-neutral-500 text-base font-medium font-['Inter'] lg:text-xl"
                    >
                      Pull Request
                    </p>
                  </div>
                </th>
                <th
                  class="text-center border border-gray-300 border-t-0 border-r-0"
                  data-sort="Issues"
                >
                  <div
                    class="flex items-center justify-center py-2 px-2 cursor-pointer"
                  >
                    <svg
                      width="21"
                      height="16"
                      viewBox="0 0 21 16"
                      fill="currentColor"
                      xmlns="http://www.w3.org/2000/svg"
                      class="text-gray-500 mr-2"
                    >
                      <path
                        d="M10.5238 10.381L15.2857 15.1429M15.2857 15.1429L20.0476 10.381M15.2857 15.1429V0.857142M1 5.61905L5.7619 0.857142M5.7619 0.857142L10.5238 5.61905M5.7619 0.857142L5.7619 15.1429"
                        stroke="currentColor"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                    </svg>
                    <p
                      class="text-neutral-500 text-base font-medium font-['Inter'] lg:text-xl"
                    >
                      Issues
                    </p>
                  </div>
                </th>
                <th
                  class="text-center border border-gray-300 border-t-0 border-r-0"
                  data-sort="First_Contribution"
                >
                  <div
                    class="flex items-center justify-center py-2 px-2 cursor-pointer"
                  >
                    <svg
                      width="21"
                      height="16"
                      viewBox="0 0 21 16"
                      fill="currentColor"
                      xmlns="http://www.w3.org/2000/svg"
                      class="text-gray-500 mr-2"
                    >
                      <path
                        d="M10.5238 10.381L15.2857 15.1429M15.2857 15.1429L20.0476 10.381M15.2857 15.1429V0.857142M1 5.61905L5.7619 0.857142M5.7619 0.857142L10.5238 5.61905M5.7619 0.857142L5.7619 15.1429"
                        stroke="currentColor"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                    </svg>
                    <p
                      class="text-neutral-500 text-base font-medium font-['Inter'] lg:text-xl"
                    >
                      First Contrib
                    </p>
                  </div>
                </th>
                <th
                  class="text-center border border-gray-300 border-t-0 border-r-0"
                  data-sort="Last_Contribution"
                >
                  <div
                    class="flex items-center justify-center py-2 px-2 cursor-pointer"
                  >
                    <svg
                      width="21"
                      height="16"
                      viewBox="0 0 21 16"
                      fill="currentColor"
                      xmlns="http://www.w3.org/2000/svg"
                      class="text-gray-500 mr-2"
                    >
                      <path
                        d="M10.5238 10.381L15.2857 15.1429M15.2857 15.1429L20.0476 10.381M15.2857 15.1429V0.857142M1 5.61905L5.7619 0.857142M5.7619 0.857142L10.5238 5.61905M5.7619 0.857142L5.7619 15.1429"
                        stroke="currentColor"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                    </svg>
                    <p
                      class="text-neutral-500 text-base font-medium font-['Inter'] lg:text-xl"
                    >
                      Last Contrib
                    </p>
                  </div>
                </th>
                <th
                  class="text-center border border-gray-300 border-t-0 border-r-0"
                  data-sort="Average_Time_Between_Commits"
                >
                  <div
                    class="flex items-center justify-center py-2 px-2 cursor-pointer"
                  >
                    <svg
                      width="21"
                      height="16"
                      viewBox="0 0 21 16"
                      fill="currentColor"
                      xmlns="http://www.w3.org/2000/svg"
                      class="text-gray-500 mr-2"
                    >
                      <path
                        d="M10.5238 10.381L15.2857 15.1429M15.2857 15.1429L20.0476 10.381M15.2857 15.1429V0.857142M1 5.61905L5.7619 0.857142M5.7619 0.857142L10.5238 5.61905M5.7619 0.857142L5.7619 15.1429"
                        stroke="currentColor"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                    </svg>
                    <p
                      class="text-neutral-500 text-base font-medium font-['Inter'] lg:text-xl"
                    >
                      Avg Commit Time
                    </p>
                  </div>
                </th>
              </tr>
            </thead>
            <tbody>
              {% for stat in stats %}
              <tr class="text-center">
                <td
                  class="px-4 py-4 border border-l-0 border-gray-300 text-left font-medium"
                >
                  {{ stat.Developer_Name }}
                </td>
                <td class="px-2 py-4 border border-gray-300 font-medium">
                  {{ stat.Commit }}
                </td>
                <td class="px-2 py-4 border border-gray-300 font-medium">
                  {{ stat.Additions }}
                </td>
                <td class="px-2 py-4 border border-gray-300 font-medium">
                  {{ stat.Deletions }}
                </td>
                <td class="px-2 py-4 border border-gray-300 font-medium">
                  {{ stat.Pull_Requests }}
                </td>
                <td class="px-2 py-4 border border-gray-300 font-medium">
                  {{ stat.Issues }}
                </td>
                <td class="px-2 py-4 border border-gray-300 font-medium">
                  {{ stat.First_Contribution }}
                </td>
                <td class="px-2 py-4 border border-gray-300 font-medium">
                  {{ stat.Last_Contribution }}
                </td>
                <td class="px-2 py-4 border-t-0 border-r-0 border border-gray-300 font-medium">
                  {{ stat.Average_Time_Between_Commits }} hours
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <!-- Content End -->

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const dropdownButton = document.querySelector(".group");
        const dropdownMenu = document.querySelector(".absolute");

        dropdownButton.addEventListener("click", function () {
          dropdownMenu.classList.toggle("hidden");
        });
      });

      document.addEventListener('DOMContentLoaded', function() {
        const backButton = document.querySelector('.back-button');
        backButton.addEventListener('click', function() {
            window.history.back();
        });
      });

      document.querySelectorAll("th[data-sort]").forEach((header) => {
        header.addEventListener("click", () => {
          const table = header.closest("table");
          const index = Array.prototype.indexOf.call(
            header.parentNode.children,
            header
          );
          const order = header.getAttribute("data-order") || "desc";
          const newOrder = order === "desc" ? "asc" : "desc";
          const rows = Array.from(table.querySelectorAll("tbody tr"));

          // Menghapus kelas dan atribut urutan sortir saat ini
          table.querySelectorAll("th[data-order]").forEach((th) => {
            th.classList.remove("ascending", "descending");
            th.removeAttribute("data-order");
          });

          // Menambahkan kelas dan atribut urutan sortir baru
          header.classList.add(newOrder);
          header.setAttribute("data-order", newOrder);

          // Mengurutkan baris tabel
          const sortedRows = rows.sort((a, b) => {
            const aValue = a.children[index].textContent;
            const bValue = b.children[index].textContent;

            if (!isNaN(aValue) && !isNaN(bValue)) {
              return newOrder === "desc" ? bValue - aValue : aValue - bValue;
            } else {
              return newOrder === "desc"
                ? bValue.localeCompare(aValue)
                : aValue.localeCompare(bValue);
            }
          });

          // Menambahkan baris tabel yang sudah diurutkan ke tbody
          table.querySelector("tbody").append(...sortedRows);
        });
      });
    </script>
  </body>
</html>
