{% load static tailwind_tags %}
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Developer Statistic</title>
        {% tailwind_css %}
        <style>
            #loadingSpinner {
                z-index: 10;
            }
            .spinner {
                border: 4px solid rgba(255, 9, 9, 0.587);
                border-radius: 50%;
                border-top: 4px solid #fff;
                width: 50px;
                height: 50px;
                -webkit-animation: spin 1s linear infinite; /* Safari */
                animation: spin 1s linear infinite;
                position: fixed;
            }
        
            /* Safari */
            @-webkit-keyframes spin {
                0% { -webkit-transform: rotate(0deg); }
                100% { -webkit-transform: rotate(360deg); }
            }
        
            @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }
        </style>
    </head>

    <body>
        <!-- Navbar Start -->
        {% block section %}
        {% include "component/navbar_logged.html" %}
        {% endblock %}
        <!-- Navbar End -->

        <div id="loadingSpinner" class="fixed inset-0 bg-gray-700 bg-opacity-50 flex justify-center items-center hidden ">
            <div class="spinner"></div>
        </div>

        <!-- Content Start -->
        <div class="bg-white">
            <div class="mx-6 pt-[100px] lg:mx-28 ">
                <button class="flex items-center back-button">
                    <svg
                        width="15"
                        height="16"
                        viewBox="0 0 15 16"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                        >
                        <path
                            d="M6.60901 0.543593L0.356415 6.78845C0.242567 6.90723 0.153324 7.04729 0.0938059 7.20061C-0.0312686 7.50468 -0.0312686 7.84575 0.0938059 8.14982C0.153324 8.30314 0.242567 8.4432 0.356415 8.56198L6.60901 14.8068C6.72561 14.9233 6.86403 15.0157 7.01637 15.0787C7.16871 15.1417 7.33199 15.1741 7.49688 15.1741C7.8299 15.1741 8.14927 15.042 8.38475 14.8068C8.62023 14.5717 8.75252 14.2527 8.75252 13.9201C8.75252 13.5875 8.62023 13.2685 8.38475 13.0333L4.25804 8.92418H13.7495C14.0811 8.92418 14.3992 8.7926 14.6337 8.55837C14.8682 8.32414 15 8.00646 15 7.67521C15 7.34397 14.8682 7.02629 14.6337 6.79206C14.3992 6.55783 14.0811 6.42624 13.7495 6.42624L4.25804 6.42624L8.38475 2.31713C8.50196 2.20102 8.59499 2.06289 8.65848 1.91069C8.72197 1.75849 8.75465 1.59524 8.75465 1.43036C8.75465 1.26548 8.72197 1.10223 8.65848 0.950037C8.59499 0.797838 8.50196 0.659702 8.38475 0.543593C8.2685 0.42653 8.13019 0.333611 7.9778 0.270203C7.82542 0.206794 7.66197 0.17415 7.49688 0.17415C7.3318 0.17415 7.16835 0.206794 7.01596 0.270203C6.86357 0.333611 6.72527 0.42653 6.60901 0.543593Z"
                            fill="#A3A3A3"
                        />
                        </svg>
                        <div
                        class="text-neutral-400 text-base font-medium p-2"
                        >
                        back
                    </div>
                </button>
                <div class="grid gap-0">
                <h2 class="text-black text-base font-bold lg:text-2xl">
                    {{ folder.Folder_Name }}'s Folder
                </h2>
                </div>
            </div>
            <div class="mx-6 my-5 shadow shadow-xl rounded-lg flex flex-col lg:mx-28 lg:my-10">
                <div class="px-4 bg-sky-100 rounded-t-lg">
                <h1 class="text-neutral-600 text-base font-semibold py-4 lg:text-xl">
                    Comparison
                </h1>
                <!-- <p class="text-neutral-400 text-base font-normal ">Total Comparison per Contributors</p> -->
                </div>
                <div class="flex-1 overflow-x-auto py-6 px-4">
                <table class="w-full table-auto">
                    <thead class="">
                    <tr class="text-neutral-500 text-xl items-center m-2 text-center">
                        <th
                        class="text-center border border-l-0 border-gray-300 border-t-0"
                        data-sort="Developer_Name"
                        >
                        <div class="flex items-center py-2 px-4 w-80 cursor-pointer">
                            <svg
                            width="21"
                            height="16"
                            viewBox="0 0 21 16"
                            fill="currentColor"
                            xmlns="http://www.w3.org/2000/svg"
                            class="text-gray-500 mr-2"
                            >
                            <path
                                d="M10.5238 10.381L15.2857 15.1429M15.2857 15.1429L20.0476 10.381M15.2857 15.1429V0.857142M1 5.61905L5.7619 0.857142M5.7619 0.857142L10.5238 5.61905M5.7619 0.857142L5.7619 15.1429"
                                stroke="currentColor"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            />
                            </svg>
                            <p
                            class="text-neutral-500 text-base font-medium font-['Inter'] lg:text-xl"
                            >
                            Repository Name
                            </p>
                        </div>
                        </th>
                        <th
                        class="text-center border border-gray-300 border-t-0"
                        data-sort="Commit"
                        >
                        <div class="flex items-center justify-center py-2 px-2 cursor-pointer">
                            <svg
                            width="21"
                            height="16"
                            viewBox="0 0 21 16"
                            fill="currentColor"
                            xmlns="http://www.w3.org/2000/svg"
                            class="text-gray-500 mr-2"
                            >
                            <path
                                d="M10.5238 10.381L15.2857 15.1429M15.2857 15.1429L20.0476 10.381M15.2857 15.1429V0.857142M1 5.61905L5.7619 0.857142M5.7619 0.857142L10.5238 5.61905M5.7619 0.857142L5.7619 15.1429"
                                stroke="currentColor"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            />
                            </svg>
                            <p
                            class="text-neutral-500 text-base font-medium font-['Inter'] lg:text-xl"
                            >
                            Commits
                            </p>
                        </div>
                        </th>
                        <th
                        class="text-center border border-gray-300 border-t-0"
                        data-sort="Additions"
                        >
                        <div
                            class="flex items-center justify-center py-2 px-2 cursor-pointer"
                        >
                            <svg
                            width="21"
                            height="16"
                            viewBox="0 0 21 16"
                            fill="currentColor"
                            xmlns="http://www.w3.org/2000/svg"
                            class="text-gray-500 mr-2"
                            >
                            <path
                                d="M10.5238 10.381L15.2857 15.1429M15.2857 15.1429L20.0476 10.381M15.2857 15.1429V0.857142M1 5.61905L5.7619 0.857142M5.7619 0.857142L10.5238 5.61905M5.7619 0.857142L5.7619 15.1429"
                                stroke="currentColor"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            />
                            </svg>
                            <p
                            class="text-neutral-500 text-base font-medium font-['Inter'] lg:text-xl"
                            >
                            Pull Req (Merged)
                            </p>
                        </div>
                        </th>
                        <th
                        class="text-center border border-gray-300 border-t-0"
                        data-sort="Deletions"
                        >
                        <div
                            class="flex items-center justify-center py-2 px-2 cursor-pointer"
                        >
                            <svg
                            width="21"
                            height="16"
                            viewBox="0 0 21 16"
                            fill="currentColor"
                            xmlns="http://www.w3.org/2000/svg"
                            class="text-gray-500 mr-2"
                            >
                            <path
                                d="M10.5238 10.381L15.2857 15.1429M15.2857 15.1429L20.0476 10.381M15.2857 15.1429V0.857142M1 5.61905L5.7619 0.857142M5.7619 0.857142L10.5238 5.61905M5.7619 0.857142L5.7619 15.1429"
                                stroke="currentColor"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            />
                            </svg>
                            <p
                            class="text-neutral-500 text-base font-medium font-['Inter'] lg:text-xl"
                            >
                            Pull Req (Rejected)
                            </p>
                        </div>
                        </th>
                        <th
                        class="text-center border border-gray-300 border-t-0 border-r-0"
                        data-sort="Pull_Request"
                        >
                        <div
                            class="flex items-center justify-center py-2 px-2 cursor-pointer"
                        >
                            <svg
                            width="21"
                            height="16"
                            viewBox="0 0 21 16"
                            fill="currentColor"
                            xmlns="http://www.w3.org/2000/svg"
                            class="text-gray-500 mr-2"
                            >
                            <path
                                d="M10.5238 10.381L15.2857 15.1429M15.2857 15.1429L20.0476 10.381M15.2857 15.1429V0.857142M1 5.61905L5.7619 0.857142M5.7619 0.857142L10.5238 5.61905M5.7619 0.857142L5.7619 15.1429"
                                stroke="currentColor"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            />
                            </svg>
                            <p
                            class="text-neutral-500 text-base font-medium font-['Inter'] lg:text-xl"
                            >
                            Contributors
                            </p>
                        </div>
                        </th>
                        <th
                        class="text-center border border-gray-300 border-t-0 border-r-0"
                        data-sort="Issues"
                        >
                        <div
                            class="flex items-center justify-center py-2 px-2 cursor-pointer"
                        >
                            <svg
                            width="21"
                            height="16"
                            viewBox="0 0 21 16"
                            fill="currentColor"
                            xmlns="http://www.w3.org/2000/svg"
                            class="text-gray-500 mr-2"
                            >
                            <path
                                d="M10.5238 10.381L15.2857 15.1429M15.2857 15.1429L20.0476 10.381M15.2857 15.1429V0.857142M1 5.61905L5.7619 0.857142M5.7619 0.857142L10.5238 5.61905M5.7619 0.857142L5.7619 15.1429"
                                stroke="currentColor"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            />
                            </svg>
                            <p
                            class="text-neutral-500 text-base font-medium font-['Inter'] lg:text-xl"
                            >
                            Languages
                            </p>
                        </div>
                        </th>
                        <th
                        class="text-center border border-gray-300 border-t-0 border-r-0"
                        data-sort="First_Contribution"
                        >
                        <div
                            class="flex items-center justify-center py-2 px-2 cursor-pointer"
                        >
                            <svg
                            width="21"
                            height="16"
                            viewBox="0 0 21 16"
                            fill="currentColor"
                            xmlns="http://www.w3.org/2000/svg"
                            class="text-gray-500 mr-2"
                            >
                            <path
                                d="M10.5238 10.381L15.2857 15.1429M15.2857 15.1429L20.0476 10.381M15.2857 15.1429V0.857142M1 5.61905L5.7619 0.857142M5.7619 0.857142L10.5238 5.61905M5.7619 0.857142L5.7619 15.1429"
                                stroke="currentColor"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            />
                            </svg>
                            <p
                            class="text-neutral-500 text-base font-medium font-['Inter'] lg:text-xl"
                            >
                            Forks
                            </p>
                        </div>
                        </th>
                        <th
                        class="text-center border border-gray-300 border-t-0 border-r-0"
                        data-sort="Last_Contribution"
                        >
                        <div
                            class="flex items-center justify-center py-2 px-2 cursor-pointer"
                        >
                            <svg
                            width="21"
                            height="16"
                            viewBox="0 0 21 16"
                            fill="currentColor"
                            xmlns="http://www.w3.org/2000/svg"
                            class="text-gray-500 mr-2"
                            >
                            <path
                                d="M10.5238 10.381L15.2857 15.1429M15.2857 15.1429L20.0476 10.381M15.2857 15.1429V0.857142M1 5.61905L5.7619 0.857142M5.7619 0.857142L10.5238 5.61905M5.7619 0.857142L5.7619 15.1429"
                                stroke="currentColor"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            />
                            </svg>
                            <p
                            class="text-neutral-500 text-base font-medium font-['Inter'] lg:text-xl"
                            >
                            Stars
                            </p>
                        </div>
                        </th>
                        <th
                        class="text-center border border-gray-300 border-t-0 border-r-0"
                        data-sort="Average_Time_Between_Commits"
                        >
                        <div
                            class="flex items-center justify-center py-2 px-2 cursor-pointer"
                        >
                            <svg
                            width="21"
                            height="16"
                            viewBox="0 0 21 16"
                            fill="currentColor"
                            xmlns="http://www.w3.org/2000/svg"
                            class="text-gray-500 mr-2"
                            >
                            <path
                                d="M10.5238 10.381L15.2857 15.1429M15.2857 15.1429L20.0476 10.381M15.2857 15.1429V0.857142M1 5.61905L5.7619 0.857142M5.7619 0.857142L10.5238 5.61905M5.7619 0.857142L5.7619 15.1429"
                                stroke="currentColor"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                            />
                            </svg>
                            <p
                            class="text-neutral-500 text-base font-medium font-['Inter'] lg:text-xl"
                            >
                            Last Updated
                            </p>
                        </div>
                        </th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for stat in stats %}
                    <tr class="text-center">
                        <td class="px-4 py-4 border border-l-0 border-gray-300 text-left font-bold">
                            {{ stat.Repository_Name }}
                        </td>
                        <td class="px-2 py-4 border border-gray-300 font-medium">
                            {{ stat.Commit }}
                        </td>
                        <td class="px-2 py-4 border border-gray-300 font-medium">
                            {{ stat.Merged_Pull_Request }}
                        </td>
                        <td class="px-2 py-4 border border-gray-300 font-medium">
                            {{ stat.Rejected_Pull_Request }}
                        </td>
                        <td class="px-2 py-4 border border-gray-300 font-medium">
                            {{ stat.Contributors }}
                        </td>
                        <td class="px-2 py-4 border border-gray-300 font-medium">
                            {{ stat.Languages }}
                        </td>
                        <td class="px-2 py-4 border border-gray-300 font-medium">
                            {{ stat.Forks }}
                        </td>
                        <td class="px-2 py-4 border border-gray-300 border-r-0 font-medium">
                            {{ stat.Stars }}
                        </td>
                        <td class="px-2 py-4 border border-gray-300 border-r-0 font-medium">
                            {{ stat.Last_Updated }}
                        </td>
                        <td class="">
                            <a href="{% url 'repository_detail' stat.repo.RepositoryID %}">
                                <svg width="28" height="28" viewBox="0 0 28 28" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M15 20V12H11V14H13V20H10V22H18V20H15ZM14 6C13.7033 6 13.4133 6.08797 13.1666 6.2528C12.92 6.41762 12.7277 6.65189 12.6142 6.92597C12.5006 7.20006 12.4709 7.50166 12.5288 7.79264C12.5867 8.08361 12.7296 8.35088 12.9393 8.56066C13.1491 8.77044 13.4164 8.9133 13.7074 8.97118C13.9983 9.02906 14.2999 8.99935 14.574 8.88582C14.8481 8.77229 15.0824 8.58003 15.2472 8.33335C15.412 8.08668 15.5 7.79667 15.5 7.5C15.5 7.10218 15.342 6.72064 15.0607 6.43934C14.7794 6.15804 14.3978 6 14 6Z"
                                    fill="black" />
                                <path
                                    d="M14 28C11.2311 28 8.52431 27.1789 6.22202 25.6406C3.91973 24.1022 2.12532 21.9157 1.06569 19.3576C0.00606596 16.7994 -0.271181 13.9845 0.269012 11.2687C0.809205 8.55301 2.14258 6.05845 4.10051 4.10051C6.05845 2.14258 8.55301 0.809205 11.2687 0.269012C13.9845 -0.271181 16.7994 0.00606596 19.3576 1.06569C21.9157 2.12532 24.1022 3.91973 25.6406 6.22202C27.1789 8.52431 28 11.2311 28 14C28 17.713 26.525 21.274 23.8995 23.8995C21.274 26.525 17.713 28 14 28ZM14 2.00001C11.6266 2.00001 9.30655 2.70379 7.33316 4.02237C5.35977 5.34095 3.8217 7.21509 2.91345 9.40781C2.0052 11.6005 1.76756 14.0133 2.23058 16.3411C2.69361 18.6689 3.83649 20.8071 5.51472 22.4853C7.19296 24.1635 9.33115 25.3064 11.6589 25.7694C13.9867 26.2325 16.3995 25.9948 18.5922 25.0866C20.7849 24.1783 22.6591 22.6402 23.9776 20.6668C25.2962 18.6935 26 16.3734 26 14C26 10.8174 24.7357 7.76516 22.4853 5.51472C20.2348 3.26429 17.1826 2.00001 14 2.00001Z"
                                    fill="black" />
                            </svg>
                            </a>
                        </td>
                    </tr>
                    {% endfor %}
                    </tbody>
                </table>
                </div>
            </div>
        </div>
        <!-- Content End -->

        <script>

            document.addEventListener("DOMContentLoaded", function () {
                const dropdownButton = document.querySelector(".group");
                const dropdownMenu = document.querySelector(".absolute");

                dropdownButton.addEventListener("click", function () {
                dropdownMenu.classList.toggle("hidden");
                });
            });

            document.addEventListener('DOMContentLoaded', function() {
                const compareButton = document.querySelector('a[href*="repository_detail"]');
                const loadingSpinner = document.getElementById('loadingSpinner');

                compareButton.addEventListener('click', function() {
                    loadingSpinner.classList.remove('hidden');
                });
            });

            document.addEventListener('DOMContentLoaded', function() {
                const backButton = document.querySelector('.back-button');
                backButton.addEventListener('click', function() {
                    window.history.back();
                });
            });

            document.querySelectorAll("th[data-sort]").forEach((header) => {
                header.addEventListener("click", () => {
                const table = header.closest("table");
                const index = Array.prototype.indexOf.call(
                    header.parentNode.children,
                    header
                );
                const order = header.getAttribute("data-order") || "desc";
                const newOrder = order === "desc" ? "asc" : "desc";
                const rows = Array.from(table.querySelectorAll("tbody tr"));

                // Menghapus kelas dan atribut urutan sortir saat ini
                table.querySelectorAll("th[data-order]").forEach((th) => {
                    th.classList.remove("ascending", "descending");
                    th.removeAttribute("data-order");
                });

                // Menambahkan kelas dan atribut urutan sortir baru
                header.classList.add(newOrder);
                header.setAttribute("data-order", newOrder);

                // Mengurutkan baris tabel
                const sortedRows = rows.sort((a, b) => {
                    const aValue = a.children[index].textContent;
                    const bValue = b.children[index].textContent;

                    if (!isNaN(aValue) && !isNaN(bValue)) {
                    return newOrder === "desc" ? bValue - aValue : aValue - bValue;
                    } else {
                    return newOrder === "desc"
                        ? bValue.localeCompare(aValue)
                        : aValue.localeCompare(bValue);
                    }
                });

                // Menambahkan baris tabel yang sudah diurutkan ke tbody
                table.querySelector("tbody").append(...sortedRows);
                });
            });
        </script>
    </body>
</html>
